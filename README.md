# PrimConsTree

`PrimConsTree` is a project that:

A consensus tree in phylogenetics is a representation that summarizes the relationships among different phylogenetic trees. It helps to identify the most supported or accepted evolutionary relationships. It thus provides a more robust understanding of evolutionary history. We study the challenge of constructing a consensus tree from a set of phylogenetic trees, each with branch-length data encoding the temporal evolution of genetic mutations. Despite the richness of this temporal information, the prevailing practice in the field tends to prioritize topological features while neglecting branch length. In response, we present a new approach that incorporates both topological information and average branch length to build a more complete consensus tree. Our adaptation of the well-known Prim algorithm efficiently identifies the minimum weight of the branch length in the consensus tree. Through empirical evaluation, we show that the proposed algorithm outperforms existing methods. This research highlights the importance of considering branch-length data in consensus tree construction and makes a valuable contribution to the field of phylogenetic analysis.

## Getting Started

These instructions will get you a copy of the `PrimConsTree` project up and running on your local machine for development and testing purposes.

### Using PrimConsTree

#### Requirements

You will need `python 3.12` with the following packages:
- networkx 3.3
- ete3 3.1.3
- matplotlib 3.9.0 (should be droped at some point but used for debug purpose)

#### How to run

The primconstree program is located at `src/primconstree.py`

It take as input the path of the input file and several optional arguments.
The input file is a text file with one tree per line, as a newick string, with branch length.

The following arguments are optionals, they are defined for evaluation purpose and default values are recommended:
- `--version <num>`: Version 1 is the latest version of PCT. Version 0 is very similar but use different criterion for the research of the Minimum Spanning Tree.
- `--avg_on_merge`: The last step of PCT is to remove unnecessary internal node (with only one child), by default branch length above and under the latter are summed. If this argument is provided the mean is used instead.
- `--debug`: display informations at several step of the algorithm.

### Developpment and Evaluation 

Along with our code are provided all the script used for evaluation of PrimConsTree. This section provide useful informations to run these scripts.

#### Requirements

First you will need `python 3.12` with the packages listed in `requirements.txt`.

**HybridSim :** Tree generation is performed with [hybridsim](https://github.com/MichaelWoodhams/HybridSim) tool, the `.jar` archive is included in `src/tools/` for convinience.
Java is required to be in the `PATH` to run the generation script.

**FACT :** If you wish to evaluate PCT against the frequency difference consensus tree you will need the [FACT2](https://github.com/Mesh89/FACT2) program.
In another hand, evaluating the majority rule + consensus tree require the [FACT](https://github.com/Mesh89/FACT) program.
Compiled versions are already included in `src/tools/`.
If you find one to not work properly, a bash script `src/tools/setup_fact.sh` is provided and can be run from the `src/tools/` directory to generate the two executables.

**tqDist :** If you wish to evaluate triplet or quartet distance you will need the [tqDist](https://www.birc.au.dk/~cstorm/software/tqdist/) package.
Installation instruction are provided in the linked website.

#### Tree generation

The script `src/eval/generate.py` is used to generate trees. A dedicated section of the script allow you to modify simulation parameters.

#### Consensus evaluation

The script `src/eval/compute.py` is used to compute consensus with several algorithms and evaluate distance to the input trees with several metrics.
Every parameters can be modified in a dedicated section of the script.
It takes as input data generated by the generation script mentioned above, and output the results as a json file.

#### Visualizing results

The notebook `src/eval/analysis.ipynb` can be used to visualize results outputed from the previous steps.
Detailed instructions are provided in the notebook.

## Contributing to `PrimConsTree`

To contribute to `PrimConsTree`, follow these steps:

1. Fork this repository.
2. Create a branch: `git checkout -b <branch_name>`.
3. Make your changes and commit them: `git commit -m '<commit_message>'`
4. Push to the original branch: `git push origin <project_name>/<location>`
5. Create the pull request.

Alternatively see the GitHub documentation on [creating a pull request](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/creating-a-pull-request).

## Contact

If you want to contact me you can reach me at `<Nadia.Tahiri@USherbrooke.ca>`.

## License

This project uses the following license: [MIT license](https://github.com/tahiri-lab/PrimConsTree?tab=MIT-1-ov-file#readme).
